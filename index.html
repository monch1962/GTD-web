<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Getting Things Done web app with smart task management">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>GTD Web - Getting Things Done</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div id="announcer" class="sr-only" aria-live="polite" aria-atomic="true"></div>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-check-circle"></i> GTD Web</h1>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <a href="#" class="nav-item active" data-view="inbox">
                        <i class="fas fa-inbox"></i>
                        <span>Inbox</span>
                        <span class="count" id="inbox-count">0</span>
                    </a>
                    <a href="#" class="nav-item" data-view="next">
                        <i class="fas fa-bolt"></i>
                        <span>Next Actions</span>
                        <span class="count" id="next-count">0</span>
                    </a>
                    <a href="#" class="nav-item" data-view="waiting">
                        <i class="fas fa-clock"></i>
                        <span>Waiting</span>
                        <span class="count" id="waiting-count">0</span>
                    </a>
                    <a href="#" class="nav-item" data-view="someday">
                        <i class="fas fa-cloud"></i>
                        <span>Someday</span>
                        <span class="count" id="someday-count">0</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-item projects-dropdown-toggle">
                        <i class="fas fa-folder"></i>
                        <span>Projects</span>
                        <span class="count" id="projects-count">0</span>
                        <i class="fas fa-chevron-down dropdown-arrow"></i>
                    </div>
                    <div class="projects-dropdown" id="projects-dropdown">
                        <!-- Projects will be dynamically added here -->
                    </div>
                    <a href="#" class="nav-item" data-view="reference">
                        <i class="fas fa-book"></i>
                        <span>Reference</span>
                        <span class="count" id="reference-count">0</span>
                    </a>
                    <a href="#" class="nav-item" id="templates-button">
                        <i class="fas fa-copy"></i>
                        <span>Templates</span>
                        <span class="count" id="templates-count">0</span>
                    </a>
                    <a href="#" class="nav-item" id="archive-button">
                        <i class="fas fa-archive"></i>
                        <span>Archive</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-header" style="padding: var(--spacing-sm) var(--spacing-lg); display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 0.8rem; font-weight: 600; text-transform: uppercase; color: var(--text-light); opacity: 0.7;">
                            <i class="fas fa-filter" style="margin-right: var(--spacing-xs);"></i> Filter by Context
                        </span>
                        <button id="clear-context-filters" class="btn btn-sm" style="padding: 2px 8px; font-size: 0.7rem; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: var(--text-light); border-radius: 4px; cursor: pointer;">
                            Clear
                        </button>
                    </div>
                    <div id="context-filters" style="padding: 0 var(--spacing-md) var(--spacing-md);">
                        <!-- Context filters will be dynamically added here -->
                    </div>
                </div>

                <div class="nav-section">
                    <a href="#" class="nav-item" data-view="all">
                        <i class="fas fa-list"></i>
                        <span>All Items</span>
                    </a>
                    <a href="#" class="nav-item" id="help-button">
                        <i class="fas fa-question-circle"></i>
                        <span>Help</span>
                    </a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="user-info" id="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="user-id">Loading...</span>
                </div>
                <button id="sync-status" class="sync-button">
                    <i class="fas fa-sync"></i>
                    <span class="sync-text">Synced</span>
                </button>
                <div style="display: flex; gap: var(--spacing-xs); margin-top: var(--spacing-sm);">
                    <button id="btn-export" class="btn btn-secondary" style="flex: 1; font-size: 0.75rem; padding: 4px 8px;" title="Export all data to JSON">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button id="btn-import" class="btn btn-secondary" style="flex: 1; font-size: 0.75rem; padding: 4px 8px;" title="Import data from JSON">
                        <i class="fas fa-upload"></i> Import
                    </button>
                </div>
                <input type="file" id="import-file-input" accept=".json" style="display: none;">
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="main-content">
            <!-- Mobile Sidebar Overlay -->
            <div class="sidebar-overlay" id="sidebar-overlay"></div>

            <!-- Hamburger Menu Button (Mobile Only) -->
            <button class="hamburger-menu" id="hamburger-menu" aria-label="Toggle menu" aria-expanded="false">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <header class="content-header">
                <div style="flex: 1; max-width: 400px; margin-right: var(--spacing-md);">
                    <div style="position: relative;">
                        <label for="global-search" class="sr-only">Search tasks</label>
                        <i class="fas fa-search" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: var(--text-secondary); aria-hidden="true"></i>
                        <input type="text" id="global-search" placeholder="Search tasks..." aria-label="Search tasks" aria-describedby="search-instructions" style="width: 100%; padding: 8px 10px 8px 32px; border: 1px solid var(--border-color); border-radius: var(--radius-sm); font-size: 0.9rem;">
                        <span id="search-instructions" class="sr-only">Type to search tasks, use arrow keys to navigate results</span>
                        <button id="clear-search" aria-label="Clear search" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--text-secondary); cursor: pointer; display: none;">
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
                <h2 id="view-title" style="margin: 0;">Inbox</h2>
                <div style="display: flex; gap: var(--spacing-sm);" role="toolbar" aria-label="Task management actions">
                    <button id="btn-dark-mode" class="btn btn-secondary" title="Toggle Dark Mode" aria-label="Toggle dark mode">
                        <i class="fas fa-moon" aria-hidden="true"></i>
                    </button>
                    <button id="btn-calendar-view" class="btn btn-secondary" title="Calendar View" aria-label="Open calendar view">
                        <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                    </button>
                    <button id="btn-focus-mode" class="btn btn-secondary" title="Focus Mode" aria-label="Enter focus mode">
                        <i class="fas fa-bullseye" aria-hidden="true"></i>
                    </button>
                    <button id="btn-new-project" class="btn btn-secondary" title="New Project" aria-label="Create new project">
                        <i class="fas fa-folder-plus" aria-hidden="true"></i>
                    </button>
                    <button id="btn-daily-review" class="btn btn-secondary" title="Daily Review" aria-label="Start daily review">
                        <i class="fas fa-sun" aria-hidden="true"></i>
                    </button>
                    <button id="btn-undo" class="btn btn-secondary" title="Undo (Ctrl+Z)" disabled aria-label="Undo last action" aria-describedby="undo-status">
                        <i class="fas fa-undo" aria-hidden="true"></i>
                    </button>
                    <span id="undo-status" class="sr-only">Undo is unavailable</span>
                    <button id="btn-redo" class="btn btn-secondary" title="Redo (Ctrl+Y)" disabled aria-label="Redo action" aria-describedby="redo-status">
                        <i class="fas fa-redo" aria-hidden="true"></i>
                    </button>
                    <span id="redo-status" class="sr-only">Redo is unavailable</span>
                    <button id="btn-weekly-review" class="btn btn-secondary" title="Weekly Review" aria-label="Start weekly review">
                        <i class="fas fa-calendar-week" aria-hidden="true"></i>
                    </button>
                    <button id="btn-dashboard" class="btn btn-secondary" title="Dashboard" aria-label="Open dashboard">
                        <i class="fas fa-chart-bar" aria-hidden="true"></i>
                    </button>
                    <button id="btn-dependencies" class="btn btn-secondary" title="Task Dependencies" aria-label="View task dependencies">
                        <i class="fas fa-project-diagram" aria-hidden="true"></i>
                    </button>
                    <button id="btn-heatmap" class="btn btn-secondary" title="Productivity Heatmap" aria-label="View productivity heatmap">
                        <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                    </button>
                    <button id="btn-bulk-select" class="btn btn-secondary" style="display: none;" aria-label="Enable bulk selection mode">
                        <i class="fas fa-check-square" aria-hidden="true"></i> Select Multiple
                    </button>
                    <button id="btn-suggestions" class="btn btn-primary" aria-label="Get smart task suggestions">
                        <i class="fas fa-lightbulb" aria-hidden="true"></i> What should I work on?
                    </button>
                </div>
            </header>

            <!-- Advanced Search Panel -->
            <div id="advanced-search-panel" style="display: none; margin-bottom: var(--spacing-md); padding: var(--spacing-md); background: var(--bg-secondary); border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                    <div>
                        <label style="display: block; font-size: 0.85rem; margin-bottom: 4px;">Context</label>
                        <select id="search-context" style="width: 100%; padding: 6px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <option value="">Any Context</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.85rem; margin-bottom: 4px;">Energy</label>
                        <select id="search-energy" style="width: 100%; padding: 6px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <option value="">Any Energy</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.85rem; margin-bottom: 4px;">Status</label>
                        <select id="search-status" style="width: 100%; padding: 6px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <option value="">Any Status</option>
                            <option value="inbox">Inbox</option>
                            <option value="next">Next Actions</option>
                            <option value="waiting">Waiting</option>
                            <option value="someday">Someday</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.85rem; margin-bottom: 4px;">Due Date</label>
                        <select id="search-due" style="width: 100%; padding: 6px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <option value="">Any Time</option>
                            <option value="overdue">Overdue</option>
                            <option value="today">Due Today</option>
                            <option value="week">Due This Week</option>
                            <option value="month">Due This Month</option>
                            <option value="nodate">No Due Date</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-size: 0.85rem; margin-bottom: 4px;">Sort By</label>
                        <select id="search-sort" style="width: 100%; padding: 6px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <option value="updated">Recently Updated</option>
                            <option value="due">Due Date</option>
                            <option value="created">Date Created</option>
                            <option value="time">Time Estimate</option>
                            <option value="title">Title (A-Z)</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: var(--spacing-sm); justify-content: space-between; align-items: center;">
                    <div>
                        <button id="save-search" class="btn btn-secondary" style="font-size: 0.85rem;">
                            <i class="fas fa-save"></i> Save Search
                        </button>
                        <select id="saved-searches" style="margin-left: var(--spacing-sm); padding: 6px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <option value="">Saved Searches...</option>
                        </select>
                        <button id="delete-saved-search" class="btn btn-secondary" style="font-size: 0.85rem; margin-left: var(--spacing-xs); display: none;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <button id="clear-advanced-search" class="btn btn-secondary" style="font-size: 0.85rem;">
                        <i class="fas fa-times"></i> Clear Filters
                    </button>
                </div>
            </div>

            <div id="bulk-actions-bar" style="display: none; margin-bottom: var(--spacing-md); padding: var(--spacing-sm); background: var(--bg-secondary); border-radius: var(--radius-md);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-sm);">
                    <span style="font-size: 0.9rem;"><strong><span id="bulk-selected-count">0</span></strong> tasks selected</span>
                    <button id="btn-bulk-select-all" class="btn btn-secondary" style="font-size: 0.85rem;" title="Select all visible tasks">
                        <i class="fas fa-check-double"></i> Select All
                    </button>
                </div>
                <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-xs); margin-top: var(--spacing-sm);">
                    <button id="btn-bulk-complete" class="btn btn-success" style="font-size: 0.85rem;">
                        <i class="fas fa-check"></i> Complete
                    </button>
                    <button id="btn-bulk-status" class="btn btn-secondary" style="font-size: 0.85rem;" title="Set Status">
                        <i class="fas fa-flag"></i> Status
                    </button>
                    <button id="btn-bulk-energy" class="btn btn-secondary" style="font-size: 0.85rem;" title="Set Energy">
                        <i class="fas fa-bolt"></i> Energy
                    </button>
                    <button id="btn-bulk-project" class="btn btn-secondary" style="font-size: 0.85rem;" title="Move to Project">
                        <i class="fas fa-folder"></i> Project
                    </button>
                    <button id="btn-bulk-context" class="btn btn-secondary" style="font-size: 0.85rem;" title="Add Context">
                        <i class="fas fa-tag"></i> Context
                    </button>
                    <button id="btn-bulk-due-date" class="btn btn-secondary" style="font-size: 0.85rem;" title="Set Due Date">
                        <i class="fas fa-calendar"></i> Due Date
                    </button>
                    <button id="btn-bulk-delete" class="btn btn-danger" style="font-size: 0.85rem;" title="Delete Tasks">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                    <button id="btn-bulk-cancel" class="btn btn-secondary" style="font-size: 0.85rem;">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>

            <div class="quick-add">
                <input type="text" id="quick-add-input" placeholder="Quick add... (Try: &quot;Call John @work tomorrow high energy&quot;)">
                <div style="margin-top: var(--spacing-sm);">
                    <button class="btn btn-secondary" id="toggle-templates" style="font-size: 0.75rem; padding: 2px 8px; margin-right: var(--spacing-xs);">
                        <i class="fas fa-clone"></i> Quick Templates
                    </button>
                    <button class="btn btn-secondary" id="toggle-nlp-help" style="font-size: 0.75rem; padding: 2px 8px;">
                        <i class="fas fa-info-circle"></i> See examples
                    </button>
                    <div id="nlp-examples" style="display: none; margin-top: var(--spacing-sm); padding: var(--spacing-sm); background: var(--bg-secondary); border-radius: var(--radius-sm); font-size: 0.8rem;">
                        <strong>Natural language examples:</strong>
                        <ul style="margin: var(--spacing-xs) 0 0 var(--spacing-sm) 0; padding-left: 20px;">
                            <li><code>Call John @work tomorrow high energy</code></li>
                            <li><code>Team meeting @computer weekly recurring</code></li>
                            <li><code>Pay bills @home monthly due 15th</code></li>
                            <li><code>Quick email 15min low energy</code></li>
                            <li><code>Gym workout @personal daily</code></li>
                            <li><code>Review project in 3 days</code></li>
                        </ul>
                    </div>
                    <div id="templates-dropdown" style="display: none; margin-top: var(--spacing-sm); padding: var(--spacing-sm); background: var(--bg-secondary); border-radius: var(--radius-sm); font-size: 0.8rem;">
                        <strong>Quick Templates:</strong>
                        <div id="quick-capture-templates-list" style="margin-top: var(--spacing-xs); display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-xs);">
                            <!-- Templates will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="quick-contexts">
                    <span class="quick-context-label">Quick contexts:</span>
                    <!-- Default context buttons will be rendered here dynamically by JavaScript -->
                    <button class="btn-create-context" id="btn-create-context">
                        <i class="fas fa-plus"></i> Create Context
                    </button>
                </div>
            </div>

            <div id="tasks-container" class="tasks-container" role="list" aria-label="Tasks" aria-live="polite">
                <!-- Tasks will be rendered here -->
            </div>

            <div id="projects-container" class="projects-container" style="display: none;">
                <!-- Projects will be rendered here -->
            </div>

            <div id="reference-container" class="reference-container" style="display: none;">
                <!-- Reference items will be rendered here -->
            </div>
        </main>

        <!-- Task/Edit Modal -->
        <div id="task-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-title">Add Task</h3>
                    <button class="close-button" id="close-modal" aria-label="Close modal">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <form id="task-form" class="task-form">
                    <input type="hidden" id="task-id">

                    <div class="form-group">
                        <label for="task-title">Title <span class="required" aria-label="required">*</span></label>
                        <input type="text" id="task-title" required aria-required="true">
                    </div>

                    <div class="form-group">
                        <label for="task-description">Description</label>
                        <textarea id="task-description" rows="3"></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-type">Type</label>
                            <select id="task-type">
                                <option value="task">Task</option>
                                <option value="project">Project</option>
                                <option value="reference">Reference</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="task-status">Status</label>
                            <select id="task-status">
                                <option value="inbox">Inbox</option>
                                <option value="next">Next Action</option>
                                <option value="waiting">Waiting</option>
                                <option value="someday">Someday</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-energy">Energy Required</label>
                            <select id="task-energy">
                                <option value="">None</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="task-time">Time Required (min)</label>
                            <input type="number" id="task-time" min="0" step="5" placeholder="0">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="task-project">Project</label>
                        <select id="task-project">
                            <option value="">No Project</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-due-date">Due Date</label>
                            <input type="date" id="task-due-date">
                        </div>

                        <div class="form-group">
                            <label for="task-defer-date">Defer Date</label>
                            <input type="date" id="task-defer-date">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="task-recurrence-type">Recurrence</label>
                        <select id="task-recurrence-type">
                            <option value="">No Recurrence</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                        <small style="color: var(--text-secondary);">Automatically create a new task when this task is completed</small>
                    </div>

                    <!-- Weekly Options -->
                    <div class="form-group" id="recurrence-weekly-options" style="display: none; padding: 12px; background: var(--bg-secondary); border-radius: var(--border-radius);">
                        <label style="font-weight: 600; margin-bottom: 8px; display: block;">Repeat on these days:</label>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <label style="flex: 0 0 auto; display: flex; align-items: center; gap: 4px;">
                                <input type="checkbox" class="recurrence-day-checkbox" value="1" data-day="Monday"> Mon
                            </label>
                            <label style="flex: 0 0 auto; display: flex; align-items: center; gap: 4px;">
                                <input type="checkbox" class="recurrence-day-checkbox" value="2" data-day="Tuesday"> Tue
                            </label>
                            <label style="flex: 0 0 auto; display: flex; align-items: center; gap: 4px;">
                                <input type="checkbox" class="recurrence-day-checkbox" value="3" data-day="Wednesday"> Wed
                            </label>
                            <label style="flex: 0 0 auto; display: flex; align-items: center; gap: 4px;">
                                <input type="checkbox" class="recurrence-day-checkbox" value="4" data-day="Thursday"> Thu
                            </label>
                            <label style="flex: 0 0 auto; display: flex; align-items: center; gap: 4px;">
                                <input type="checkbox" class="recurrence-day-checkbox" value="5" data-day="Friday"> Fri
                            </label>
                            <label style="flex: 0 0 auto; display: flex; align-items: center; gap: 4px;">
                                <input type="checkbox" class="recurrence-day-checkbox" value="6" data-day="Saturday"> Sat
                            </label>
                            <label style="flex: 0 0 auto; display: flex; align-items: center; gap: 4px;">
                                <input type="checkbox" class="recurrence-day-checkbox" value="7" data-day="Sunday"> Sun
                            </label>
                        </div>
                    </div>

                    <!-- Monthly Options -->
                    <div class="form-group" id="recurrence-monthly-options" style="display: none; padding: 12px; background: var(--bg-secondary); border-radius: var(--border-radius);">
                        <div style="margin-bottom: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="radio" name="monthly-recurrence-type" value="day-of-month" checked>
                                <span>Day of month:</span>
                                <input type="number" id="recurrence-day-of-month" min="1" max="31" value="1" style="width: 70px; padding: 4px 8px;">
                                <span style="font-size: 0.9rem; color: var(--text-secondary);">(1-31)</span>
                            </label>
                        </div>
                        <div style="border-top: 1px solid var(--border-color); padding-top: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="radio" name="monthly-recurrence-type" value="nth-weekday">
                                <span>The</span>
                                <select id="recurrence-nth" style="padding: 4px 8px;">
                                    <option value="1">1st</option>
                                    <option value="2">2nd</option>
                                    <option value="3">3rd</option>
                                    <option value="4">4th</option>
                                    <option value="5">5th</option>
                                </select>
                                <select id="recurrence-weekday" style="padding: 4px 8px;">
                                    <option value="1">Monday</option>
                                    <option value="2">Tuesday</option>
                                    <option value="3">Wednesday</option>
                                    <option value="4">Thursday</option>
                                    <option value="5">Friday</option>
                                    <option value="6">Saturday</option>
                                    <option value="7">Sunday</option>
                                </select>
                                <span>of each month</span>
                            </label>
                        </div>
                    </div>

                    <!-- Yearly Options -->
                    <div class="form-group" id="recurrence-yearly-options" style="display: none; padding: 12px; background: var(--bg-secondary); border-radius: var(--border-radius);">
                        <label>Repeat on this day each year:</label>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <select id="recurrence-year-month" style="padding: 4px 8px;">
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                            <input type="number" id="recurrence-year-day" min="1" max="31" value="1" style="width: 70px; padding: 4px 8px;">
                            <span style="font-size: 0.9rem; color: var(--text-secondary);">(day)</span>
                        </div>
                    </div>

                    <div class="form-group" id="recurrence-end-date-group" style="display: none;">
                        <label for="task-recurrence-end-date">Recurrence End Date</label>
                        <input type="date" id="task-recurrence-end-date">
                        <small style="color: var(--text-secondary);">Optional: Stop creating recurring tasks after this date</small>
                    </div>

                    <div class="form-group" id="waiting-for-section" style="display: none;">
                        <label for="task-waiting-for-description">Waiting Description</label>
                        <input type="text" id="task-waiting-for-description" placeholder="e.g., Response from John, Design team approval">
                        <small style="color: var(--text-secondary);">What/who are you waiting for?</small>
                    </div>

                    <div class="form-group" id="waiting-for-deps-section" style="display: none;">
                        <label for="task-waiting-for-tasks">Waiting (Task Dependencies)</label>
                        <div id="waiting-for-tasks-list" style="max-height: 150px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: var(--radius-sm); padding: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                            <p style="color: var(--text-secondary); font-size: 0.875rem;">No task dependencies selected</p>
                        </div>
                        <small style="color: var(--text-secondary);">Select tasks that must be completed before this task becomes actionable</small>
                    </div>

                    <div class="form-group">
                        <label for="task-contexts">Contexts (comma separated)</label>
                        <input type="text" id="task-contexts" placeholder="@home, @computer, @urgent">
                        <small style="color: var(--text-secondary);">Contexts must start with @ (e.g., @home, @work, @urgent)</small>
                        <div class="quick-contexts-modal">
                            <!-- Default context buttons will be rendered here dynamically by JavaScript -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="task-notes">Notes</label>
                        <textarea id="task-notes" rows="4" placeholder="Add notes, progress updates, or any other information about this task..."></textarea>
                        <small style="color: var(--text-secondary);">Track progress, store ideas, or add any other information</small>
                    </div>

                    <div class="form-group">
                        <label for="new-subtask-input">Subtasks / Checklist</label>
                        <div id="subtasks-container" role="list" aria-label="Subtasks" style="border: 1px solid var(--border-color); border-radius: var(--radius-sm); padding: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                            <p style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: var(--spacing-sm);">No subtasks yet. Add subtasks to break down this task into smaller steps.</p>
                        </div>
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <input type="text" id="new-subtask-input" placeholder="Add a subtask..." aria-label="New subtask" style="flex: 1; padding: 6px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <button type="button" class="btn btn-secondary" id="btn-add-subtask" aria-label="Add subtask">
                                <i class="fas fa-plus" aria-hidden="true"></i> Add
                            </button>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save" aria-hidden="true"></i> Save
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancel-modal">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Project Modal -->
        <div id="project-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="project-modal-title">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="project-modal-title">Add Project</h3>
                    <button class="close-button" id="close-project-modal" aria-label="Close project modal">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <form id="project-form" class="task-form">
                    <input type="hidden" id="project-id">

                    <div class="form-group">
                        <label for="project-title">Title <span class="required" aria-label="required">*</span></label>
                        <input type="text" id="project-title" required aria-required="true">
                    </div>

                    <div class="form-group">
                        <label for="project-description">Description</label>
                        <textarea id="project-description" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="project-status">Status</label>
                        <select id="project-status">
                            <option value="active">Active</option>
                            <option value="someday">Someday</option>
                            <option value="completed">Completed</option>
                            <option value="archived">Archived</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="project-contexts">Contexts (comma separated)</label>
                        <input type="text" id="project-contexts" placeholder="@work, @personal">
                        <small style="color: var(--text-secondary);">Contexts must start with @ (e.g., @home, @work)</small>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save" aria-hidden="true"></i> Save
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancel-project-modal">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Context Creation Modal -->
    <div id="context-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="context-modal-title">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="context-modal-title">Create New Context</h3>
                <button class="close-button" id="close-context-modal" aria-label="Close context modal">&times;</button>
            </div>
            <form id="context-form" class="task-form">
                <div class="form-group">
                    <label for="context-name">Context Name <span class="required" aria-label="required">*</span></label>
                    <input type="text" id="context-name" required aria-required="true" placeholder="@urgent, @review, @priority">
                    <small style="color: var(--text-secondary); margin-top: 4px; display: block;">
                        Contexts must start with @ symbol (e.g., @errands, @work, @urgent). The @ will be added automatically if missing.
                    </small>
                </div>

                <div id="context-error" role="alert" aria-live="assertive" style="color: var(--danger-color); display: none; margin-bottom: 1rem;"></div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus" aria-hidden="true"></i> Create Context
                    </button>
                    <button type="button" class="btn btn-secondary" id="cancel-context-modal">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="help-modal-title">
        <div class="modal-content" style="max-width: 900px; max-height: 85vh; overflow-y: auto;">
            <div class="modal-header">
                <h3 id="help-modal-title">GTD Web - Help & Instructions</h3>
                <button class="close-button" id="close-help-modal" aria-label="Close help modal">&times;</button>
            </div>
            <div class="help-content" style="padding: var(--spacing-lg);">
                <h4>Getting Started with GTD</h4>
                <p>Welcome to GTD Web! This app implements David Allen's Getting Things Done methodology to help you stay organized and productive.</p>

                <h5>Core Concepts</h5>
                <ul>
                    <li><strong>Inbox</strong> - Quick capture for all new tasks and ideas. Process these regularly.</li>
                    <li><strong>Next Actions</strong> - Actionable tasks you can do right now.</li>
                    <li><strong>Waiting</strong> - Tasks you're waiting on someone/something else for.</li>
                    <li><strong>Someday</strong> - Tasks you might do later, but not now.</li>
                    <li><strong>Projects</strong> - Multi-step outcomes that require multiple tasks with progress tracking.</li>
                    <li><strong>Reference</strong> - Non-actionable information you want to keep.</li>
                </ul>

                <h5>New Features</h5>
                <ul>
                    <li><strong>üîÑ Advanced Recurrence</strong> - Set specific days for weekly (Mon/Wed/Fri), nth weekday for monthly (3rd Thursday), specific dates for yearly (Jan 15th)</li>
                    <li><strong>üîó Drag-and-Drop Dependencies</strong> - In project view, drag one task onto another to create dependencies</li>
                    <li><strong>üì¶ Project Archive/Delete</strong> - Empty or completed projects show Archive/Delete buttons for easy cleanup</li>
                    <li><strong>üìä Task Dependencies Visualization</strong> - View task dependencies with graph view, chains, and critical path</li>
                    <li><strong>üìÖ Productivity Heatmap</strong> - GitHub-style calendar showing task completion activity</li>
                    <li><strong>‚å®Ô∏è Global Quick Capture</strong> - Press Alt+N anywhere to instantly capture tasks</li>
                    <li><strong>‚è±Ô∏è Focus Timer Auto-Integration</strong> - Timer auto-starts in Focus Mode, auto-stops on completion</li>
                    <li><strong>üéØ Priority Scoring</strong> - Automatic 0-100 priority scores on all tasks</li>
                    <li><strong>üì¶ Archive System</strong> - Archive completed tasks to reduce clutter</li>
                    <li><strong>üñ±Ô∏è Quick Actions Menu</strong> - Right-click tasks for quick actions</li>
                    <li><strong>üìù Smart Date Suggestions</strong> - Natural language date parsing (in 3 days, tomorrow)</li>
                    <li><strong>‚è≥ Task Countdown Badges</strong> - See days remaining on due tasks</li>
                    <li><strong>üìà Enhanced Analytics</strong> - Productivity trends, task lifecycle, completion velocity</li>
                    <li><strong>‚úÖ Bulk Operations</strong> - Set status, energy, context, due dates on multiple tasks</li>
                    <li><strong>‚≠ê Task Starring</strong> - Star important tasks to keep them at the top of your lists</li>
                    <li><strong>üìã Task Templates</strong> - Create reusable templates for repetitive workflows</li>
                    <li><strong>‚òÄÔ∏è Daily Review</strong> - Quick daily workflow to plan your day (sun icon)</li>
                    <li><strong>‚úèÔ∏è Quick Edit Inline</strong> - Double-click any task title to edit instantly</li>
                    <li><strong>üì± Enhanced Mobile</strong> - Touch-optimized interface with full-screen modals</li>
                    <li><strong>üåô Dark Mode</strong> - Toggle in header (moon icon) or uses system preference</li>
                    <li><strong>üéØ Focus Mode</strong> - Distraction-free work with Pomodoro timer (bullseye icon)</li>
                    <li><strong>‚ö° Quick Capture</strong> - Floating + button for instant task capture</li>
                    <li><strong>‚Ü©Ô∏è Undo/Redo</strong> - Full history with Ctrl+Z / Ctrl+Y shortcuts</li>
                </ul>

                <h5>Task Dependencies Visualization</h5>
                <ul>
                    <li>Click the graph icon in the header to open Dependencies modal</li>
                    <li><strong>Graph View</strong> - Visual tree showing task dependencies with connection lines</li>
                    <li><strong>Dependency Chains</strong> - Sequential lists showing A‚ÜíB‚ÜíC task chains</li>
                    <li><strong>Critical Path</strong> - Timeline showing the longest chain of dependent tasks</li>
                    <li>Statistics: total tasks, blocked tasks, ready-to-start tasks</li>
                    <li>Filter by project to see specific dependency relationships</li>
                    <li>Click any task node to edit it directly</li>
                </ul>

                <h5>Productivity Heatmap</h5>
                <ul>
                    <li>Click the calendar icon in the header to view your productivity heatmap</li>
                    <li>Shows task completion activity for the last 365 days</li>
                    <li>Color-coded intensity (5 levels from gray to dark green)</li>
                    <li>Statistics: total completed, best day, average per day, current streak</li>
                    <li>Hover over any day to see exact completion count and date</li>
                    <li>Track your productivity patterns and stay motivated</li>
                </ul>

                <h5>Global Quick Capture (Alt+N)</h5>
                <ul>
                    <li>Press <strong>Alt+N</strong> anywhere in the app to instantly capture tasks</li>
                    <li>Beautiful overlay modal with auto-focus</li>
                    <li>Enhanced parsing: <code>@context</code>, <code>!high</code>, <code>#project</code>, <code>today/tomorrow</code></li>
                    <li>Press <strong>T</strong> to browse and select templates</li>
                    <li>Press <strong>Enter</strong> to save, <strong>Escape</strong> to cancel</li>
                    <li>Perfect for capturing ideas without leaving your current context</li>
                </ul>

                <h5>Focus Timer Auto-Integration</h5>
                <ul>
                    <li><strong>Auto-start</strong>: Pomodoro timer starts automatically when entering Focus Mode</li>
                    <li><strong>Auto-track</strong>: Time spent on focused task is tracked automatically</li>
                    <li><strong>Auto-stop</strong>: Timer stops automatically when completing a task</li>
                    <li>Toast notifications show time tracked when exiting focus mode</li>
                    <li>Seamless workflow - no manual timer management needed</li>
                </ul>

                <h5>Advanced Recurrence</h5>
                <ul>
                    <li><strong>Weekly with specific days</strong>: Select "Weekly" recurrence, then check specific days (e.g., Mondays, Wednesdays, Fridays)</li>
                    <li><strong>Monthly with day number</strong>: Select "Monthly" and choose a specific day (1-31)</li>
                    <li><strong>Monthly with nth weekday</strong>: Select "Monthly" and choose "The [3rd] [Thursday]" pattern</li>
                    <li><strong>Yearly with specific date</strong>: Select "Yearly" and choose month and day (e.g., January 15th, July 4th)</li>
                    <li>Tasks automatically create the next occurrence when completed</li>
                    <li>Set optional end date to stop recurrence</li>
                    <li>Backward compatible with simple daily/weekly/monthly/yearly recurrence</li>
                </ul>

                <h5>Drag-and-Drop Task Dependencies</h5>
                <ul>
                    <li>Only works when viewing a project (click into a project first)</li>
                    <li><strong>To create dependency</strong>: Drag one task by its handle (‚â°) and drop it onto another task</li>
                    <li>The dropped task becomes a <strong>prerequisite</strong> (must be done first)</li>
                    <li>The target task becomes <strong>dependent</strong> (waits for the prerequisite)</li>
                    <li>Visual feedback: dashed border and "üîó Drop to create dependency" tooltip appears</li>
                    <li>Dependencies can only be created between tasks in the same project</li>
                    <li><strong>Circular dependencies</strong> are automatically prevented (e.g., A depends on B, B depends on A)</li>
                    <li>Tasks with dependencies automatically move to "Waiting" status</li>
                    <li>When prerequisite completes, dependent task moves to "Next Actions"</li>
                </ul>

                <h5>Project Archive & Delete</h5>
                <ul>
                    <li><strong>When to use</strong>: Projects with no incomplete tasks show Archive/Delete buttons</li>
                    <li>Buttons appear for:
                        <ul>
                            <li>Projects that truly have no tasks</li>
                            <li>Projects where all tasks are completed (message: "All tasks completed!")</li>
                        </ul>
                    </li>
                    <li><strong>Archive</strong>: Hides the project but keeps all data (can be restored later)</li>
                    <li><strong>Delete</strong>: Permanently removes the project (tasks are not deleted, just unassigned)</li>
                    <li><strong>To restore archived projects</strong>: Click "Show Archived" button in Projects view, then click "Restore"</li>
                    <li>Keeps your active project list clean and focused</li>
                </ul>

                <h5>Task Priority Scoring</h5>
                <ul>
                    <li>Automatic 0-100 score on all incomplete tasks</li>
                    <li>Color-coded badges: Red (80+, Urgent), Orange (60-79, High), Yellow (40-59, Medium), Blue (20-39, Low), Gray (0-19, Very Low)</li>
                    <li>Factors considered: due date, starred status, task status, dependencies, energy, time estimate, project priority, age</li>
                    <li>Hover over score to see priority label</li>
                    <li>Tasks automatically sorted by priority (starred first, then by score)</li>
                    <li>Helps you focus on what matters most</li>
                </ul>

                <h5>Archive System</h5>
                <ul>
                    <li>Click the Archive icon in the sidebar to access archived tasks</li>
                    <li><strong>Auto-Archive</strong>: Archive tasks completed more than 30 days ago</li>
                    <li>Search and filter archived tasks by project</li>
                    <li>Restore archived tasks with one click</li>
                    <li>Delete archived tasks permanently</li>
                    <li>Keeps your active workspace clean and focused</li>
                </ul>

                <h5>Quick Actions Context Menu</h5>
                <ul>
                    <li>Right-click on any task to open the context menu</li>
                    <li>Mobile: Long-press (500ms) to open context menu</li>
                    <li>Quick actions: edit, duplicate, toggle star, set status, set energy, move to project, add/remove context</li>
                    <li>Complete or delete tasks directly from the menu</li>
                    <li>Much faster than opening the full edit modal</li>
                </ul>

                <h5>Smart Date Suggestions</h5>
                <ul>
                    <li>Type natural language in date fields and see smart suggestions</li>
                    <li>Supports: "in 3 days", "tomorrow", "next week", "end of month"</li>
                    <li>Click any suggestion to auto-fill the date</li>
                    <li>Works for both due dates and defer dates</li>
                    <li>Makes date entry faster and more intuitive</li>
                </ul>

                <h5>Task Countdown Badges</h5>
                <ul>
                    <li>Shows "Due in X days" badge on tasks with due dates</li>
                    <li>Color-coded: Red (‚â§2 days), Orange (3-5 days), Yellow (6-7 days)</li>
                    <li>Only shows for tasks due within 14 days</li>
                    <li>Helps you prioritize time-sensitive tasks at a glance</li>
                </ul>

                <h5>Bulk Operations</h5>
                <ul>
                    <li>Click "Select Multiple" button to enter bulk selection mode</li>
                    <li>Check tasks to select them, or use "Select All" for all visible tasks</li>
                    <li>Bulk actions: complete, set status, set energy, move to project, add context, set due date, delete</li>
                    <li>All bulk operations support undo/redo</li>
                    <li>Dramatically speeds up managing multiple tasks</li>
                </ul>

                <h5>Task Starring</h5>
                <ul>
                    <li>Click the star icon on any task to mark it as important</li>
                    <li>Starred tasks always appear at the top of your lists</li>
                    <li>Perfect for today's must-do items or high-priority tasks</li>
                    <li>Click again to unstar</li>
                </ul>

                <h5>Task Templates</h5>
                <ul>
                    <li>Click "Templates" in the sidebar to access templates</li>
                    <li>Create templates for repetitive tasks (weekly reports, meeting prep, checklists)</li>
                    <li>Templates include: title, description, contexts, energy, time, notes, and subtasks</li>
                    <li>Organized by category: General, Work, Personal, Meeting, Checklist</li>
                    <li>Click "Create Task" on any template to create a new task instantly</li>
                    <li>Save time on recurring workflows!</li>
                </ul>

                <h5>Daily Review Mode</h5>
                <ul>
                    <li>Click the sun icon (Daily Review) in the header</li>
                    <li>See time-based greeting and overview of your day</li>
                    <li>Review: tasks due today, overdue tasks, starred tasks, inbox items</li>
                    <li>Quick actions: capture new tasks, process inbox, review next actions</li>
                    <li>Complete tasks directly from the review with one click</li>
                    <li>Use morning, midday, or evening for different perspectives</li>
                </ul>

                <h5>Quick Edit Inline</h5>
                <ul>
                    <li>Double-click any task title to edit it instantly</li>
                    <li>Press Enter to save, Escape to cancel</li>
                    <li>Much faster than opening the full edit modal</li>
                    <li>Perfect for quick corrections and updates</li>
                    <li>Great for mobile users - double tap to edit</li>
                </ul>

                <h5>Creating Tasks</h5>
                <ol>
                    <li><strong>Quick Add</strong> - Type in the input box and press Enter</li>
                    <li><strong>Quick Capture</strong> - Click floating + button (bottom-right)</li>
                    <li><strong>Natural Language</strong> - Type "Call mom @phone high 30min tomorrow"</li>
                    <li><strong>Detailed Add</strong> - Click "Add Task" button for full details including notes and subtasks</li>
                </ol>

                <h5>Managing Projects</h5>
                <ol>
                    <li><strong>Create</strong> - Click "New Project" button (folder icon) in header</li>
                    <li><strong>Convert Task</strong> - Edit any task and change Type to "Project"</li>
                    <li><strong>View Progress</strong> - Progress bars show completion percentage</li>
                    <li><strong>Health Status</strong> - üü¢ Good | üü° Warning | üî¥ Critical</li>
                    <li><strong>Auto-assign Tasks</strong> - When viewing a project, new tasks automatically assign to that project</li>
                    <li><strong>Drag-and-Drop Dependencies</strong> - In project view, drag tasks onto each other to create dependencies</li>
                    <li><strong>Archive/Delete</strong> - Projects with no incomplete tasks show Archive/Delete buttons</li>
                    <li><strong>Show Archived</strong> - Toggle to view and restore archived projects</li>
                </ol>

                <h5>Focus Mode & Pomodoro</h5>
                <ul>
                    <li>Click the bullseye icon to enter Focus Mode</li>
                    <li>Select a task from smart suggestions</li>
                    <li>Use Pomodoro timer: 25 min work, 5 min break</li>
                    <li>Work distraction-free in full-screen view</li>
                    <li>Timer notifies you when sessions complete</li>
                </ul>

                <h5>Using Notes & Subtasks</h5>
                <ul>
                    <li><strong>Notes</strong> - Click sticky note icon on any task to add/view notes</li>
                    <li><strong>Subtasks</strong> - Edit task to add checklist items</li>
                    <li>Progress shows on task card (e.g., "2/5 subtasks")</li>
                    <li>Great for multi-step processes and checklists</li>
                </ul>

                <h5>Calendar View</h5>
                <ul>
                    <li>Click calendar icon to see tasks by due date</li>
                    <li>Navigate months with prev/next buttons</li>
                    <li>Click tasks on calendar to see details</li>
                </ul>

                <h5>Advanced Sorting & Filtering</h5>
                <ul>
                    <li>Click in search box to open advanced filters</li>
                    <li><strong>Sort by:</strong> Recently Updated, Due Date, Created, Time, Title</li>
                    <li><strong>Filter by:</strong> Context, Energy, Status, Due date range</li>
                    <li>Save frequently-used searches for quick access</li>
                </ul>

                <h5>Using Contexts</h5>
                <ul>
                    <li><strong>Default Contexts:</strong> @home, @work, @personal, @computer, @phone, @errand</li>
                    <li><strong>Custom Contexts:</strong> Click "Create Context" button to make your own</li>
                    <li><strong>Delete Contexts:</strong> Click the √ó button on custom contexts</li>
                    <li>Click context buttons to quickly add them to tasks</li>
                    <li>Use context filter in header to filter tasks</li>
                </ul>

                <h5>Task Dependencies (Waiting)</h5>
                <ol>
                    <li><strong>Method 1 - Drag & Drop (in project view)</strong>:
                        <ul>
                            <li>Navigate into a project</li>
                            <li>Drag one task onto another to create dependency</li>
                            <li>Dropped task = prerequisite (must be done first)</li>
                            <li>Target task = dependent (waits for prerequisite)</li>
                        </ul>
                    </li>
                    <li><strong>Method 2 - Manual (any view)</strong>:
                        <ul>
                            <li>Create or edit a task</li>
                            <li>Set status to "Waiting"</li>
                            <li><strong>Description:</strong> What/who are you waiting for?</li>
                            <li><strong>Dependencies:</strong> Select tasks that must complete first</li>
                        </ul>
                    </li>
                    <li>When dependencies are met, tasks automatically move to Next Actions!</li>
                    <li>Circular dependencies are automatically prevented</li>
                </ol>

                <h5>Time Tracking</h5>
                <ul>
                    <li>Click timer icon on any task to start/stop tracking</li>
                    <li>View analytics in Dashboard (chart icon)</li>
                    <li>See time spent by context and project</li>
                    <li>Track average time per task</li>
                </ul>

                <h5>Undo/Redo</h5>
                <ul>
                    <li><strong>Ctrl+Z</strong> - Undo last action</li>
                    <li><strong>Ctrl+Y</strong> or <strong>Ctrl+Shift+Z</strong> - Redo action</li>
                    <li>Click undo/redo buttons in header</li>
                    <li>Tracks up to 50 actions</li>
                    <li>Toast notifications show what was undone/redone</li>
                </ul>

                <h5>Dates & Deadlines</h5>
                <ul>
                    <li><strong>Due Date</strong> - When a task must be done. Overdue tasks show in red.</li>
                    <li><strong>Defer Date</strong> - Hide a task until this date (great for future tasks)</li>
                    <li>Tasks with defer dates won't show in Next Actions until the date arrives</li>
                    <li>Calendar view shows all tasks by due date</li>
                </ul>

                <h5>Export/Import</h5>
                <ul>
                    <li><strong>Export</strong> - Click Export button in sidebar to download JSON backup</li>
                    <li><strong>Import</strong> - Click Import button to restore from backup</li>
                    <li>Files are timestamped (e.g., gtd-backup-2025-01-06-14-30-45.json)</li>
                    <li>Regular backups recommended!</li>
                </ul>

                <h5>Workflow Tips</h5>
                <ol>
                    <li><strong>Capture Everything</strong> - Use Quick Capture (+ button) for instant capture</li>
                    <li><strong>Process Inbox Daily</strong> - Decide what each item means and where it goes</li>
                    <li><strong>Daily Review</strong> - Start your day with Daily Review (sun icon) to plan ahead</li>
                    <li><strong>Review Weekly</strong> - Use Weekly Review for comprehensive cleanup</li>
                    <li><strong>Focus Mode</strong> - Use Pomodoro technique for deep work sessions</li>
                    <li><strong>Match Energy</strong> - Filter tasks by energy level based on how you feel</li>
                    <li><strong>Check Calendar</strong> - Review upcoming tasks and deadlines</li>
                    <li><strong>Use Templates</strong> - Create templates for repetitive tasks to save time</li>
                    <li><strong>Star Important Tasks</strong> - Keep high-priority items at the top of your list</li>
                </ol>

                <h5>Mobile Tips</h5>
                <ul>
                    <li><strong>Touch-Friendly</strong> - All buttons are 44px or larger for easy tapping</li>
                    <li><strong>Full-Screen Forms</strong> - Edit forms take full screen on mobile for better usability</li>
                    <li><strong>Quick Capture</strong> - Use floating + button for fast task entry on the go</li>
                    <li><strong>Double Tap</strong> - Double-tap task titles to edit them inline</li>
                    <li><strong>Daily Review</strong> - Perfect for planning your day while mobile</li>
                    <li><strong>Templates</strong> - Save time on mobile by using templates for common tasks</li>
                    <li><strong>Portrait Mode</strong> - Works best for viewing task lists</li>
                    <li><strong>No Accidental Zoom</strong> - Form inputs won't cause the screen to zoom</li>
                </ul>

                <h5>Keyboard Shortcuts</h5>
                <ul>
                    <li><strong>Alt+N</strong> - Open global quick capture overlay (works from anywhere)</li>
                    <li><strong>Enter</strong> - Submit task (in input fields)</li>
                    <li><strong>Escape</strong> - Close modals, cancel quick capture</li>
                    <li><strong>Ctrl+Z</strong> - Undo last action</li>
                    <li><strong>Ctrl+Y</strong> - Redo action</li>
                    <li><strong>T</strong> - Browse templates (in quick capture overlay)</li>
                </ul>

                <h5>Data Storage</h5>
                <p>All data is stored locally in your browser's localStorage. Your tasks stay private on your device. Clearing browser data will delete your tasks, so use the Export feature regularly to back up your data.</p>

                <h5>Need More Help?</h5>
                <p>Check the README.md file in the project repository for detailed documentation and troubleshooting tips.</p>
            </div>
        </div>
    </div>

    <!-- Gantt Chart Modal -->
    <div id="gantt-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="gantt-modal-title">
        <div class="modal-content" style="max-width: 90%; width: 1400px;">
            <div class="modal-header">
                <h3 id="gantt-modal-title">Project Gantt Chart</h3>
                <button class="close-button" id="close-gantt-modal" aria-label="Close Gantt chart modal">&times;</button>
            </div>
            <div class="gantt-container" id="gantt-chart">
                <!-- Gantt chart will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Dashboard Modal -->
    <div id="dashboard-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="dashboard-modal-title">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="dashboard-modal-title">Productivity Dashboard</h2>
                <button class="close-button" id="close-dashboard-modal" aria-label="Close dashboard modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <div id="dashboard-content">
                    <!-- Dashboard will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Daily Review Modal -->
    <div id="daily-review-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="daily-review-modal-title">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="daily-review-modal-title"><i class="fas fa-sun" aria-hidden="true"></i> Daily Review</h2>
                <button class="close-button" id="close-daily-review-modal" aria-label="Close daily review modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <div id="daily-review-content">
                    <!-- Daily review will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Weekly Review Modal -->
    <div id="weekly-review-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="weekly-review-modal-title">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="weekly-review-modal-title">Weekly Review</h2>
                <button class="close-button" id="close-weekly-review-modal" aria-label="Close weekly review modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <div id="weekly-review-content">
                    <!-- Weekly review will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Calendar View Modal -->
    <div id="calendar-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="calendar-modal-title">
        <div class="modal-content" style="max-width: 1000px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="calendar-modal-title">Calendar View</h2>
                <button class="close-button" id="close-calendar-modal" aria-label="Close calendar modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <div id="calendar-content">
                    <!-- Calendar will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Templates Modal -->
    <div id="templates-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="templates-modal-title">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="templates-modal-title">Task Templates</h2>
                <button class="close-button" id="close-templates-modal" aria-label="Close templates modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <div style="margin-bottom: var(--spacing-lg);">
                    <button id="btn-create-template" class="btn btn-primary">
                        <i class="fas fa-plus" aria-hidden="true"></i> Create Template
                    </button>
                </div>
                <div id="templates-list">
                    <!-- Templates will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Template Edit Modal -->
    <div id="template-edit-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="template-modal-title">
        <div class="modal-content" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="template-modal-title">Create Template</h2>
                <button class="close-button" id="close-template-edit-modal" aria-label="Close template modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <form id="template-form">
                    <input type="hidden" id="template-id">

                    <div class="form-group">
                        <label for="template-title">Title <span class="required" aria-label="required">*</span></label>
                        <input type="text" id="template-title" class="form-control" required aria-required="true">
                    </div>

                    <div class="form-group">
                        <label for="template-description">Description</label>
                        <textarea id="template-description" class="form-control" rows="3"></textarea>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-md);">
                        <div class="form-group">
                            <label for="template-energy">Energy Level</label>
                            <select id="template-energy" class="form-control">
                                <option value="">None</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="template-time">Time Estimate (minutes)</label>
                            <input type="number" id="template-time" class="form-control" min="0" value="0">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="template-category">Category</label>
                        <select id="template-category" class="form-control">
                            <option value="general">General</option>
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                            <option value="meeting">Meeting</option>
                            <option value="checklist">Checklist</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Contexts</label>
                        <div id="template-contexts-container" class="contexts-container" role="group" aria-label="Template contexts">
                            <!-- Context buttons will be rendered here -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="template-notes">Notes</label>
                        <textarea id="template-notes" class="form-control" rows="4" placeholder="Add detailed notes or instructions..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Subtasks / Checklist</label>
                        <div id="template-subtasks-container" role="list" aria-label="Template subtasks">
                            <!-- Subtasks will be rendered here -->
                        </div>
                        <button type="button" class="btn btn-secondary" id="btn-add-template-subtask" style="margin-top: var(--spacing-sm);" aria-label="Add subtask to template">
                            <i class="fas fa-plus" aria-hidden="true"></i> Add Subtask
                        </button>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save" aria-hidden="true"></i> Save Template
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancel-template-modal">
                            <i class="fas fa-times" aria-hidden="true"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Archive Modal -->
    <div id="archive-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="archive-modal-title">
        <div class="modal-content" style="max-width: 1000px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="archive-modal-title"><i class="fas fa-archive" aria-hidden="true"></i> Task Archive</h2>
                <button class="close-button" id="close-archive-modal" aria-label="Close archive modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <div style="margin-bottom: var(--spacing-lg);">
                    <button id="btn-auto-archive" class="btn btn-primary">
                        <i class="fas fa-magic" aria-hidden="true"></i> Auto-Archive Old Tasks
                    </button>
                    <span style="margin-left: var(--spacing-md); color: var(--text-secondary); font-size: 0.9rem;">
                        Archive tasks completed more than 30 days ago
                    </span>
                </div>

                <div style="margin-bottom: var(--spacing-lg);">
                    <div style="display: flex; gap: var(--spacing-sm); align-items: center;">
                        <input type="text" id="archive-search" placeholder="Search archived tasks..." style="flex: 1; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);" />
                        <select id="archive-filter-project" style="padding: 8px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                            <option value="">All Projects</option>
                        </select>
                    </div>
                </div>

                <div id="archive-stats" style="margin-bottom: var(--spacing-md); padding: var(--spacing-md); background: var(--bg-secondary); border-radius: var(--radius-md);">
                    <strong>Archive Stats:</strong> <span id="archive-count">0</span> tasks archived
                </div>

                <div id="archive-list">
                    <!-- Archived tasks will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Task Dependencies Modal -->
    <div id="dependencies-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="dependencies-modal-title">
        <div class="modal-content" style="max-width: 1200px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="dependencies-modal-title"><i class="fas fa-project-diagram" aria-hidden="true"></i> Task Dependencies</h2>
                <button class="close-button" id="close-dependencies-modal" aria-label="Close dependencies modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <!-- View Toggle -->
                <div role="toolbar" aria-label="Dependency view options" style="margin-bottom: var(--spacing-md); display: flex; gap: var(--spacing-sm); align-items: center; flex-wrap: wrap;">
                    <button id="deps-view-graph" class="btn btn-primary" style="font-size: 0.9rem;" aria-label="Show graph view">
                        <i class="fas fa-sitemap" aria-hidden="true"></i> Graph View
                    </button>
                    <button id="deps-view-chains" class="btn btn-secondary" style="font-size: 0.9rem;" aria-label="Show dependency chains">
                        <i class="fas fa-stream" aria-hidden="true"></i> Dependency Chains
                    </button>
                    <button id="deps-view-critical" class="btn btn-secondary" style="font-size: 0.9rem;" aria-label="Show critical path">
                        <i class="fas fa-exclamation-triangle" aria-hidden="true"></i> Critical Path
                    </button>
                    <div style="flex: 1;"></div>
                    <label for="deps-filter-project" class="sr-only">Filter by project</label>
                    <select id="deps-filter-project" style="padding: 6px 12px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                        <option value="">All Projects</option>
                    </select>
                </div>

                <!-- Statistics -->
                <div id="deps-stats" role="region" aria-label="Dependency statistics" style="margin-bottom: var(--spacing-lg); padding: var(--spacing-md); background: var(--bg-secondary); border-radius: var(--radius-md); display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--spacing-md);">
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--primary-color);" id="deps-total-tasks">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">Total Tasks</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--warning-color);" id="deps-with-deps">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">With Dependencies</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--danger-color);" id="deps-blocked">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">Blocked Tasks</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--success-color);" id="deps-ready">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">Ready to Start</div>
                    </div>
                </div>

                <!-- Content Area -->
                <div id="deps-content" role="region" aria-live="polite">
                    <!-- Dependencies visualization will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Productivity Heatmap Modal -->
    <div id="heatmap-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="heatmap-modal-title">
        <div class="modal-content" style="max-width: 1000px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 id="heatmap-modal-title"><i class="fas fa-calendar-alt" aria-hidden="true"></i> Productivity Heatmap</h2>
                <button class="close-button" id="close-heatmap-modal" aria-label="Close heatmap modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: var(--spacing-lg);">
                <!-- Statistics -->
                <div role="region" aria-label="Productivity statistics" style="margin-bottom: var(--spacing-lg); padding: var(--spacing-md); background: var(--bg-secondary); border-radius: var(--radius-md); display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--spacing-md);">
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--primary-color);" id="heatmap-total-completed">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">Total Completed</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--success-color);" id="heatmap-best-day">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">Best Day</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--warning-color);" id="heatmap-avg-day">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">Avg/Day</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--info-color);" id="heatmap-streak">0</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">Current Streak</div>
                    </div>
                </div>

                <!-- Heatmap Container -->
                <div id="heatmap-container" style="margin-bottom: var(--spacing-lg);">
                    <!-- GitHub-style heatmap will be rendered here -->
                </div>

                <!-- Legend -->
                <div style="display: flex; justify-content: center; align-items: center; gap: var(--spacing-sm); font-size: 0.85rem; color: var(--text-secondary);">
                    <span>Less</span>
                    <div style="display: flex; gap: 2px;">
                        <div class="heatmap-cell" style="background: #ebedf0;"></div>
                        <div class="heatmap-cell" style="background: #9be9a8;"></div>
                        <div class="heatmap-cell" style="background: #40c463;"></div>
                        <div class="heatmap-cell" style="background: #30a14e;"></div>
                        <div class="heatmap-cell" style="background: #216e39;"></div>
                    </div>
                    <span>More</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions Context Menu -->
    <div id="context-menu" class="context-menu" style="display: none; position: fixed; z-index: 10000; min-width: 200px;">
        <div class="context-menu-item" data-action="edit">
            <i class="fas fa-edit"></i> Edit
        </div>
        <div class="context-menu-item" data-action="duplicate">
            <i class="fas fa-copy"></i> Duplicate
        </div>
        <div class="context-menu-item" data-action="save-as-template">
            <i class="fas fa-file-alt"></i> Save as Template
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="toggle-star">
            <i class="fas fa-star"></i> Toggle Star
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-submenu">
            <div class="context-menu-item">
                <i class="fas fa-flag"></i> Set Status <i class="fas fa-chevron-right" style="float: right;"></i>
            </div>
            <div class="context-menu-submenu-content">
                <div class="context-menu-item" data-action="set-status" data-status="inbox">
                    <i class="fas fa-inbox"></i> Inbox
                </div>
                <div class="context-menu-item" data-action="set-status" data-status="next">
                    <i class="fas fa-bolt"></i> Next Actions
                </div>
                <div class="context-menu-item" data-action="set-status" data-status="waiting">
                    <i class="fas fa-clock"></i> Waiting
                </div>
                <div class="context-menu-item" data-action="set-status" data-status="someday">
                    <i class="fas fa-cloud"></i> Someday
                </div>
            </div>
        </div>
        <div class="context-menu-submenu">
            <div class="context-menu-item">
                <i class="fas fa-bolt"></i> Set Energy <i class="fas fa-chevron-right" style="float: right;"></i>
            </div>
            <div class="context-menu-submenu-content">
                <div class="context-menu-item" data-action="set-energy" data-energy="">
                    <i class="fas fa-times-circle"></i> None
                </div>
                <div class="context-menu-item" data-action="set-energy" data-energy="high">
                    <i class="fas fa-bolt" style="color: var(--energy-high);"></i> High
                </div>
                <div class="context-menu-item" data-action="set-energy" data-energy="medium">
                    <i class="fas fa-bolt" style="color: var(--energy-medium);"></i> Medium
                </div>
                <div class="context-menu-item" data-action="set-energy" data-energy="low">
                    <i class="fas fa-bolt" style="color: var(--energy-low);"></i> Low
                </div>
            </div>
        </div>
        <div class="context-menu-submenu">
            <div class="context-menu-item">
                <i class="fas fa-folder"></i> Move to Project <i class="fas fa-chevron-right" style="float: right;"></i>
            </div>
            <div class="context-menu-submenu-content" id="context-menu-projects">
                <!-- Projects will be dynamically added here -->
            </div>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="add-context">
            <i class="fas fa-tag"></i> Add Context
        </div>
        <div class="context-menu-item" data-action="remove-context">
            <i class="fas fa-eraser"></i> Remove Context
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item context-menu-danger" data-action="complete">
            <i class="fas fa-check-circle"></i> Complete
        </div>
        <div class="context-menu-item context-menu-danger" data-action="archive">
            <i class="fas fa-archive"></i> Archive
        </div>
        <div class="context-menu-item context-menu-danger" data-action="delete">
            <i class="fas fa-trash"></i> Delete
        </div>
    </div>

    <!-- Focus Mode Overlay -->
    <div id="focus-mode-overlay" class="focus-overlay" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-primary); z-index: 10000; padding: var(--spacing-lg); flex-direction: column;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
            <button id="btn-exit-focus" class="btn btn-secondary">
                <i class="fas fa-times"></i> Exit Focus
            </button>
            <div id="pomodoro-timer" style="font-size: 3rem; font-weight: bold; color: var(--primary-color);">25:00</div>
            <div style="display: flex; gap: var(--spacing-sm);">
                <button id="btn-pomodoro-start" class="btn btn-success">
                    <i class="fas fa-play"></i> Start
                </button>
                <button id="btn-pomodoro-pause" class="btn btn-warning" style="display: none;">
                    <i class="fas fa-pause"></i> Pause
                </button>
                <button id="btn-pomodoro-reset" class="btn btn-secondary">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
        </div>
        <div id="focus-task-container" style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; max-width: 800px; margin: 0 auto;">
            <!-- Focus task will be rendered here -->
        </div>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav" id="bottom-nav">
        <button class="bottom-nav-item" data-view="inbox" aria-label="Inbox">
            <i class="fas fa-inbox"></i>
            <span>Inbox</span>
        </button>
        <button class="bottom-nav-item" data-view="next" aria-label="Next Actions">
            <i class="fas fa-bolt"></i>
            <span>Next</span>
        </button>
        <button class="bottom-nav-item" data-view="waiting" aria-label="Waiting">
            <i class="fas fa-clock"></i>
            <span>Waiting</span>
        </button>
        <button class="bottom-nav-item" id="fab-quick-add" aria-label="Quick Add Task">
            <i class="fas fa-plus"></i>
        </button>
        <button class="bottom-nav-item" id="btn-templates-mobile" aria-label="Templates">
            <i class="fas fa-copy"></i>
            <span>Templates</span>
        </button>
        <button class="bottom-nav-item" id="btn-search-mobile" aria-label="Search">
            <i class="fas fa-search"></i>
            <span>Search</span>
        </button>
    </nav>

    <!-- Quick Capture Widget -->
    <div id="quick-capture-widget" class="quick-capture-widget">
        <button id="quick-capture-toggle" class="quick-capture-toggle" title="Quick Capture (Alt+N)">
            <i class="fas fa-plus"></i>
        </button>
        <div id="quick-capture-panel" class="quick-capture-panel" style="display: none;">
            <input type="text" id="quick-capture-input" placeholder="Quick add a task... (Alt+N)" />
            <div class="quick-capture-contexts" id="quick-capture-contexts">
                <!-- Context buttons will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Global Quick Capture Overlay -->
    <div id="global-quick-capture-overlay" class="global-quick-capture-overlay" style="display: none;">
        <div class="global-quick-capture-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-md);">
                <h2 style="margin: 0;"><i class="fas fa-bolt"></i> Quick Capture</h2>
                <button id="close-global-quick-capture" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-secondary);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <input type="text" id="global-quick-capture-input" placeholder="Type task and press Enter..." autofocus />
            <div style="margin-top: var(--spacing-sm); font-size: 0.85rem; color: var(--text-secondary);">
                <p><strong>Quick shortcuts:</strong></p>
                <ul style="margin: var(--spacing-xs) 0; padding-left: 20px;">
                    <li><code>@context</code> - Add context</li>
                    <li><code>!high</code> <code>!medium</code> <code>!low</code> - Set energy</li>
                    <li><code>#project</code> - Add to project</li>
                    <li><code>today</code> <code>tomorrow</code> - Set due date</li>
                </ul>
                <p style="margin-top: var(--spacing-sm);"><strong>Templates:</strong> Press <code>T</code> to browse templates</p>
            </div>
            <div id="global-quick-capture-templates" style="margin-top: var(--spacing-md); display: none;">
                <h3 style="font-size: 1rem; margin-bottom: var(--spacing-sm);">Select a Template:</h3>
                <div id="global-quick-capture-templates-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: var(--spacing-sm);">
                    <!-- Templates will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
